model Appointment {
  id            Int                @id @default(autoincrement())
  customerName  String
  whatsapp      String

  /// 👇 NUEVO: solo dígitos para comparaciones
  whatsappNormalized String        @default("")

  barber        Barber             @relation(fields: [barberId], references: [id])
  barberId      Int
  service       Service            @relation(fields: [serviceId], references: [id])
  serviceId     Int

  start         DateTime
  end           DateTime

  /// 👇 NUEVO: fecha de la cita (sin hora) para validar “una por día”
  appointmentDate DateTime         @db.Date

  status        AppointmentStatus  @default(SCHEDULED)
  notes         String?
  createdAt     DateTime           @default(now())

  @@index([barberId, start, end])
  @@index([serviceId])

  /// 👇 NUEVO: índice compuesto que acelera la validación por día
  @@index([whatsappNormalized, appointmentDate])
}